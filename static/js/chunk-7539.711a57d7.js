(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7539"],{"/0fE":function(e,t,a){},"1jBe":function(e,t,a){"use strict";a.r(t);var l=a("cLjf"),i=a.n(l),s=a("hDQ3"),n=a.n(s),r=a("bS4n"),o=a.n(r),u=a("Mz3J"),c=a("Qn0k"),p=a("2wEF"),d=a("IL3p"),m=a.n(d),g={props:{gameDialogVisible:{type:Boolean,required:!0},title:{type:String,default:"请选择游戏"},allGames:{type:Array,default:function(){return[]}},selectGames:{type:Array,default:function(){return[]}}},data:function(){return{type:[]}},methods:{handleOpen:function(){this.type=m()(this.selectGames)},handleCancel:function(){this.type=[],this.$emit("update:gameDialogVisible",!1)},handleConfirm:function(){this.$emit("on-confirm",this.type)}}},f=(a("5aJA"),a("AcaB"),a("ZrdR")),y=Object(f.a)(g,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.gameDialogVisible,title:e.title,"append-to-body":"",width:"36%"},on:{open:e.handleOpen,close:e.handleCancel}},[a("div",{staticClass:"checkbox-container"},[a("el-checkbox-group",{model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.allGames,function(t,l){return a("el-checkbox",{key:l,attrs:{label:t.id}},[e._v(e._s(t.gamename))])}),1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确 定")])],1)])},[],!1,null,"d88a2642",null);y.options.__file="chooseGameDialog.vue";var b=y.exports,h={props:{playerDialogVisible:{type:Boolean,required:!0},title:{type:String,default:"请选择标签"},selectTags:{type:Array,default:function(){return[]}},allPlayerTags:{type:Array,default:function(){return[]}}},data:function(){return{type:[]}},methods:{handleOpen:function(){this.type=m()(this.selectTags)},handleCancel:function(){this.type=[],this.$emit("update:playerDialogVisible",!1)},handleConfirm:function(){this.$emit("on-confirm",this.type)}}},_=(a("Pm0I"),a("rqwi"),Object(f.a)(h,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.playerDialogVisible,title:e.title,"append-to-body":"",width:"36%"},on:{open:e.handleOpen,close:e.handleCancel}},[a("div",{staticClass:"checkbox-container"},[a("el-checkbox-group",{model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.allPlayerTags,function(e,t){return a("el-checkbox",{key:t,attrs:{label:e}})}),1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确 定")])],1)])},[],!1,null,"19cea8ea",null));_.options.__file="choosePlayerDialog.vue";var v=_.exports,L=[{key:"Longtugame",display_name:"龙图游戏"},{key:"Other",display_name:"其他"}].reduce(function(e,t){return e[t.key]=t.display_name,e},{}),k={components:{chooseGameDialog:b,choosePlayerDialog:v},filters:{platformFilter:function(e){return L[e]}},props:{visibility:{type:Boolean,required:!0},title:{type:String,required:!0},fullscreen:{type:Boolean,default:!1},userData:{type:Object,required:!0},allPlayerTags:{type:Array,default:function(){return[]}},allGames:{type:Object,default:function(){return{}}},buttonDisable:{type:Boolean,default:!1},top:{type:String,default:"10vh"},confirmBtnText:{type:String,default:"确定"}},data:function(){return{gameDialogVisible:!1,playerDialogVisible:!1,listQuery:{openid:""},gamesLabelList:[],allGamesName:[],allGamesList:[],playerLabelList:[]}},computed:{styleWidth:function(){return{width:"180px"}},selectGameid:function(){return this.gamesLabelList.map(function(e){return e.id})}},methods:{handleOpen:function(){var e=m()(this.userData),t=e.usergames;this.listQuery.openid=e.user_id,this.playerLabelList=e.player_tag,this.gamesLabelList=this.getNameAndItem(this.allGames,t)},handleCancel:function(){this.allGamesName=[],this.allGamesList=[],this.$emit("update:visibility",!1)},handleConfirm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var a={openid:t.listQuery.openid,playertags:t.playerLabelList,usergames:t.selectGameid};t.$emit("on-manage",a)})},openGameDialog:function(){this.gameDialogVisible=!0},openPlayerDialog:function(){this.playerDialogVisible=!0},getNameAndItem:function(e,t){for(var a in e)this.allGamesName.push({id:e[a].id,gamename:e[a].gamename}),this.allGamesList.push(e[a]);return this._getGameList(this.allGamesList,t)},handleSelectGame:function(e){this.gamesLabelList=this._getGameList(this.allGamesList,e),this.gameDialogVisible=!1},handleSelectTags:function(e){this.playerLabelList=e,this.playerDialogVisible=!1},_getGameList:function(e,t){var a=[];t=t.map(Number);for(var l=0;l<t.length;l++)for(var i=0;i<e.length;i++)t[l]===e[i].id&&a.push(e[i]);return a}}},w=(a("8kjE"),Object(f.a)(k,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.visibility,title:e.title,fullscreen:e.fullscreen,top:e.top,width:"80%"},on:{open:e.handleOpen,close:e.handleCancel}},[a("el-form",{ref:"vipForm",staticClass:"form-inline",attrs:{inline:!0,model:e.listQuery}},[a("el-form-item",{attrs:{label:"用户ID"}},[a("el-input",{style:e.styleWidth,attrs:{disabled:!0},model:{value:e.listQuery.openid,callback:function(t){e.$set(e.listQuery,"openid",t)},expression:"listQuery.openid"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户游戏标签"}},[a("span",{staticClass:"select-tags"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.openGameDialog}},[e._v("管理用户标签")])],1)]),e._v(" "),a("el-form-item",{attrs:{label:"玩家认定标签"}},[a("span",{staticClass:"select-tags"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.openPlayerDialog}},[e._v("管理用户标签")])],1)])],1),e._v(" "),e.gamesLabelList.length>0?a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.gamesLabelList,border:"",fit:""}},[a("el-table-column",{attrs:{label:"游戏名称",width:"150",prop:"gamename",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"所属平台",width:"150",prop:"platform",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("platformFilter")(t.row.platform)))])]}}],null,!1,637489951)}),e._v(" "),a("el-table-column",{staticClass:"tags-item",attrs:{label:"玩法标签"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.play_tags,function(t,l){return a("el-tag",{key:l,staticClass:"tag",attrs:{type:"info"}},[e._v(e._s(t))])})}}],null,!1,2719446709)}),e._v(" "),a("el-table-column",{staticClass:"tags-item",attrs:{label:"风格标签"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.style_tags,function(t,l){return a("el-tag",{key:l,staticClass:"tag",attrs:{type:"info"}},[e._v(e._s(t))])})}}],null,!1,4163140326)})],1):e._e(),e._v(" "),e.playerLabelList.length>0?a("div",{staticClass:"player-label-container"},[a("h1",{staticClass:"title-first"},[e._v("玩家认定标签")]),e._v(" "),e._l(e.playerLabelList,function(t,l){return a("el-tag",{key:l,staticClass:"tag",attrs:{type:"info"}},[e._v(e._s(t))])})],2):e._e(),e._v(" "),a("choose-game-dialog",{attrs:{"game-dialog-visible":e.gameDialogVisible,"all-games":e.allGamesName,"select-games":e.selectGameid},on:{"update:gameDialogVisible":function(t){e.gameDialogVisible=t},"update:game-dialog-visible":function(t){e.gameDialogVisible=t},"on-confirm":e.handleSelectGame}}),e._v(" "),a("choose-player-dialog",{attrs:{"player-dialog-visible":e.playerDialogVisible,"select-tags":e.playerLabelList,"all-player-tags":e.allPlayerTags},on:{"update:playerDialogVisible":function(t){e.playerDialogVisible=t},"update:player-dialog-visible":function(t){e.playerDialogVisible=t},"on-confirm":e.handleSelectTags}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{disabled:e.buttonDisable,type:"primary"},on:{click:function(t){return e.handleConfirm("vipForm")}}},[e._v(e._s(e.confirmBtnText))])],1)],1)},[],!1,null,"258a1ac3",null));w.options.__file="index.vue";var T=w.exports,D=a("2nGb"),x=a("0o2y"),G=a("8t5x"),C=a("ct8p"),Q=[{key:"Longtugame",display_name:"龙图游戏"},{key:"Other",display_name:"其他"}].reduce(function(e,t){return e[t.key]=t.display_name,e},{}),V={components:{Pagination:u.a,ManageLabel:c.a,AddGame:p.a,UserLabelManage:T},filters:{platformFilter:function(e){return Q[e]}},provide:function(){return{refreshLabel:this.getUserTagsList}},mixins:[C.a],data:function(){return{listQuery:{openid:"",username:"",play_tags:"",style_tags:"",page:1,limit:10},total:0,loading:!0,userLabelVisible:!1,manageLabelVisible:!1,labelList:[],userData:{},playTagOptions:[],styleTagOptions:[],playerTags:[],gameNames:null,userTagList:[],buttonDisable:!1}},computed:o()({styleWidth:function(){return{width:"240px"}}},Object(G.b)(["rules"])),created:function(){var e=this;setTimeout(function(){e.getUserTagsList()},20)},methods:{getUserTagsList:function(){var e=this;return n()(i.a.mark(function t(){var a,l,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(x.a)(e.listQuery);case 3:a=t.sent,l=a.code,s=a.data,e.loading=!1,l===D.a&&(e.userTagList=s.list,e.total=s.total,e.playTagOptions=s.playTagOptions,e.styleTagOptions=s.styleTagOptions,e.playerTags=s.playerTags,e.gameNames=s.gameNames,e.labelList=e.collectTags(s));case 8:case"end":return t.stop()}},t,e)}))()},onQuery:function(){this.getUserTagsList()},onReset:function(e){this.$refs[e].resetFields(),this.getUserTagsList()},handleManageLabel:function(){this.manageLabelVisible=!0},showAddGame:function(){this.addGameVisible=!0},handleManagement:function(e){this.userData=e,this.userLabelVisible=!0},handleDeleteTag:function(e){var t=this,a=e.user_id,l=e.game_id;this.$confirm("此操作将永久删除该用户标签, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.deleteUserTags(a,l)}).catch(function(){})},deleteUserTags:function(e,t){var a=this;return n()(i.a.mark(function l(){var s,n,r;return i.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,Object(x.c)({userid:e,gameid:t});case 2:s=l.sent,n=s.code,r=s.msg,n===D.a?(a.$message({type:"success",message:r}),a.getUserTagsList()):a.$message({type:"warning",message:r});case 6:case"end":return l.stop()}},l,a)}))()},onManageLabel:function(e){var t=this;return n()(i.a.mark(function a(){var l,s,n;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.buttonDisable=!0,a.next=3,Object(x.d)(e);case 3:l=a.sent,s=l.code,n=l.msg,t.buttonDisable=!1,s===D.a?(t.getUserTagsList(),t.$message({type:"success",message:n}),t.userLabelVisible=!1):t.$message({type:"warning",message:n});case 8:case"end":return a.stop()}},a,t)}))()}}},O=(a("g03R"),Object(f.a)(V,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-form",{ref:"usertagForm",staticClass:"form-inline",attrs:{inline:!0,model:e.listQuery,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"用户ID",prop:"openid"}},[a("el-input",{style:e.styleWidth,attrs:{placeholder:"请输入"},model:{value:e.listQuery.openid,callback:function(t){e.$set(e.listQuery,"openid",t)},expression:"listQuery.openid"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{style:e.styleWidth,attrs:{placeholder:"请输入"},model:{value:e.listQuery.username,callback:function(t){e.$set(e.listQuery,"username",t)},expression:"listQuery.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"玩法标签",prop:"play_tags"}},[a("el-select",{style:e.styleWidth,attrs:{clearable:"",placeholder:"请选择"},model:{value:e.listQuery.play_tags,callback:function(t){e.$set(e.listQuery,"play_tags",t)},expression:"listQuery.play_tags"}},e._l(e.playTagOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"风格标签",prop:"style_tags"}},[a("el-select",{style:e.styleWidth,attrs:{clearable:"",placeholder:"请选择"},model:{value:e.listQuery.style_tags,callback:function(t){e.$set(e.listQuery,"style_tags",t)},expression:"listQuery.style_tags"}},e._l(e.styleTagOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{"margin-left":"20px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.onQuery}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:function(t){return e.onReset("usertagForm")}}},[e._v("重置")])],1)],1)],1),e._v(" "),a("div",{staticClass:"top-operate"},[e.rules.TagsAddGames?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.showAddGame}},[e._v("添加游戏")]):e._e(),e._v(" "),e.rules.TagsManage?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleManageLabel}},[e._v("管理标签")]):e._e()],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.userTagList,border:"",fit:""}},[a("el-table-column",{attrs:{label:"用户ID",fixed:"",prop:"user_id",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户名",prop:"user_name",width:"120",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"游戏名称",width:"120",prop:"game_name",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"所属平台",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("platformFilter")(t.row.platform)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"玩法标签","min-width":"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.play_tags,function(t,l){return a("el-tag",{key:l,staticClass:"tag",attrs:{type:"info"}},[e._v(e._s(t))])})}}])}),e._v(" "),a("el-table-column",{attrs:{label:"风格标签","min-width":"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.style_tags,function(t,l){return a("el-tag",{key:l,staticClass:"tag",attrs:{type:"info"}},[e._v(e._s(t))])})}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"148",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.rules.TagsUserLabel?a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.handleManagement(t.row)}}},[e._v("管理")]):e._e(),e._v(" "),e.rules.TagsLabelDelete?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDeleteTag(t.row)}}},[e._v("删除")]):e._e()]}}])})],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getUserTagsList}}),e._v(" "),a("manage-label",{attrs:{visible:e.manageLabelVisible,"label-data":e.labelList,title:"管理标签"},on:{"update:visible":function(t){e.manageLabelVisible=t}}}),e._v(" "),a("add-game",{attrs:{visible:e.addGameVisible,play_tags:e.playTagOptions,style_tags:e.styleTagOptions,type:"on-add",title:"添加游戏"},on:{"update:visible":function(t){e.addGameVisible=t},"on-add":e.handleAddGame}}),e._v(" "),a("user-label-manage",{attrs:{visibility:e.userLabelVisible,"user-data":e.userData,"all-player-tags":e.playerTags,"all-games":e.gameNames,"button-disable":e.buttonDisable,"confirm-btn-text":"确定",title:"用户标签管理"},on:{"update:visibility":function(t){e.userLabelVisible=t},"on-manage":e.onManageLabel}})],1)},[],!1,null,"4284f9fd",null));O.options.__file="index.vue";t.default=O.exports},"30X5":function(e,t,a){},"5aJA":function(e,t,a){"use strict";var l=a("94W7");a.n(l).a},"8kjE":function(e,t,a){"use strict";var l=a("aedj");a.n(l).a},"94W7":function(e,t,a){},AcaB:function(e,t,a){"use strict";var l=a("30X5");a.n(l).a},G8Qi:function(e,t,a){},Pm0I:function(e,t,a){"use strict";var l=a("hQSO");a.n(l).a},aedj:function(e,t,a){},g03R:function(e,t,a){"use strict";var l=a("/0fE");a.n(l).a},hQSO:function(e,t,a){},rqwi:function(e,t,a){"use strict";var l=a("G8Qi");a.n(l).a}}]);